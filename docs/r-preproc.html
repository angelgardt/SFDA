<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>21&nbsp; Предобработка данных – SFDA | PSY HSE</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./r-vis.html" rel="next">
<link href="./r-intro.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Ничего не найдено",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Очистить",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Отмена",
    "search-submit-button-title": "Отправить",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./part-r.html">Анализ данных в R</a></li><li class="breadcrumb-item"><a href="./r-preproc.html"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Предобработка данных</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">SFDA | PSY HSE</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Начало</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Введение в статистику</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Основания статистики</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-randvals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Шкалы и&nbsp;случайные величины</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-desc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Описательная статистика</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./desc-centraltend.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Меры центральной тенденции</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./desc-variation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Меры разброса</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./desc-normdist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Нормальное распределение</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./desc-ci.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Доверительные интервалы</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-infer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Статистика вывода</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-stattesting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Тестирование статистических гипотез</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-categorical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Анализ категориальных данных</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Корреляционный анализ</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-anovaI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Однофакторный дисперсионный анализ</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-anovaII.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Многофакторный дисперсионный анализ</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-posthoc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Post hoc тесты</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-simplelinear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Простая линейная регрессия</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-multiplelinear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Множественная линейная регрессия</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ковариационный анализ</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-logreg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Логистическая регрессия</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Кластерный анализ</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-efa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Эксплораторный факторный анализ</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-cfa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Конфирматорный факторный анализ</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Анализ данных в R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Основы R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-preproc.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Предобработка данных</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-vis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Визуализация данных</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Корреляция и&nbsp;регрессия</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Дисперсионный анализ</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Логистическая регрессия</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Кластерный анализ</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-efa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Эксплораторный факторный анализ</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-cfa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Конфирматорный факторный анализ</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./outro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">[Не]конец</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Содержание</h2>
   
  <ul>
  <li><a href="#install.packagestidyverse-dependencies-true" id="toc-install.packagestidyverse-dependencies-true" class="nav-link active" data-scroll-target="#install.packagestidyverse-dependencies-true"><span class="header-section-number">22</span> install.packages(“tidyverse”, dependencies = TRUE)</a>
  <ul class="collapse">
  <li><a href="#working-dir" id="toc-working-dir" class="nav-link" data-scroll-target="#working-dir"><span class="header-section-number">22.1</span> working dir</a></li>
  </ul></li>
  <li><a href="#getwd" id="toc-getwd" class="nav-link" data-scroll-target="#getwd"><span class="header-section-number">23</span> getwd()</a></li>
  <li><a href="#setwd" id="toc-setwd" class="nav-link" data-scroll-target="#setwd"><span class="header-section-number">24</span> setwd()</a>
  <ul class="collapse">
  <li><a href="#get-data" id="toc-get-data" class="nav-link" data-scroll-target="#get-data"><span class="header-section-number">24.1</span> get data</a></li>
  <li><a href="#httpswww.kaggle.comdatasetsmylesoneillgame-of-thrones" id="toc-httpswww.kaggle.comdatasetsmylesoneillgame-of-thrones" class="nav-link" data-scroll-target="#httpswww.kaggle.comdatasetsmylesoneillgame-of-thrones"><span class="header-section-number">24.2</span> https://www.kaggle.com/datasets/mylesoneill/game-of-thrones</a></li>
  <li><a href="#what-is-pipe-and-how-it-works" id="toc-what-is-pipe-and-how-it-works" class="nav-link" data-scroll-target="#what-is-pipe-and-how-it-works"><span class="header-section-number">24.3</span> what is pipe and how it works</a></li>
  </ul></li>
  <li><a href="#deaths" id="toc-deaths" class="nav-link" data-scroll-target="#deaths"><span class="header-section-number">25</span> deaths %&gt;%</a></li>
  <li><a href="#rename_all.funs-str_replace_all" id="toc-rename_all.funs-str_replace_all" class="nav-link" data-scroll-target="#rename_all.funs-str_replace_all"><span class="header-section-number">26</span> rename_all(.funs = str_replace_all,</a></li>
  <li><a href="#pattern" id="toc-pattern" class="nav-link" data-scroll-target="#pattern"><span class="header-section-number">27</span> pattern = ” “,</a></li>
  <li><a href="#replacement-_" id="toc-replacement-_" class="nav-link" data-scroll-target="#replacement-_"><span class="header-section-number">28</span> replacement = “_“) %&gt;%</a></li>
  <li><a href="#rename_alltolower" id="toc-rename_alltolower" class="nav-link" data-scroll-target="#rename_alltolower"><span class="header-section-number">29</span> rename_all(tolower) %&gt;%</a></li>
  <li><a href="#colnames" id="toc-colnames" class="nav-link" data-scroll-target="#colnames"><span class="header-section-number">30</span> colnames()</a></li>
  <li><a href="#colnamesdeaths_no_allegiance" id="toc-colnamesdeaths_no_allegiance" class="nav-link" data-scroll-target="#colnamesdeaths_no_allegiance"><span class="header-section-number">31</span> colnames(deaths_no_allegiance)</a></li>
  <li><a href="#colnamesdeaths" id="toc-colnamesdeaths" class="nav-link" data-scroll-target="#colnamesdeaths"><span class="header-section-number">32</span> colnames(deaths)</a>
  <ul class="collapse">
  <li><a href="#nas" id="toc-nas" class="nav-link" data-scroll-target="#nas"><span class="header-section-number">32.1</span> NAs</a></li>
  <li><a href="#install-required-packages" id="toc-install-required-packages" class="nav-link" data-scroll-target="#install-required-packages"><span class="header-section-number">32.2</span> install required packages</a></li>
  </ul></li>
  <li><a href="#install.packagestidyverse-moments" id="toc-install.packagestidyverse-moments" class="nav-link" data-scroll-target="#install.packagestidyverse-moments"><span class="header-section-number">33</span> install.packages(“tidyverse”, “moments”)</a>
  <ul class="collapse">
  <li><a href="#another-way-to-install-required-packages-more-safe" id="toc-another-way-to-install-required-packages-more-safe" class="nav-link" data-scroll-target="#another-way-to-install-required-packages-more-safe"><span class="header-section-number">33.1</span> another way to install required packages, more safe</a></li>
  <li><a href="#load-required-package" id="toc-load-required-package" class="nav-link" data-scroll-target="#load-required-package"><span class="header-section-number">33.2</span> load required package</a></li>
  <li><a href="#create-subfolder-for-data-files" id="toc-create-subfolder-for-data-files" class="nav-link" data-scroll-target="#create-subfolder-for-data-files"><span class="header-section-number">33.3</span> create subfolder for data files</a></li>
  </ul></li>
  <li><a href="#dir.createdata" id="toc-dir.createdata" class="nav-link" data-scroll-target="#dir.createdata"><span class="header-section-number">34</span> dir.create(“data”)</a>
  <ul class="collapse">
  <li><a href="#read-csv-file-separator-is-comma-data-of-got-charaster-deaths" id="toc-read-csv-file-separator-is-comma-data-of-got-charaster-deaths" class="nav-link" data-scroll-target="#read-csv-file-separator-is-comma-data-of-got-charaster-deaths"><span class="header-section-number">34.1</span> read csv file, separator is comma — data of GoT charaster deaths</a></li>
  <li><a href="#source-httpswww.kaggle.comdatasetsmylesoneillgame-of-thrones" id="toc-source-httpswww.kaggle.comdatasetsmylesoneillgame-of-thrones" class="nav-link" data-scroll-target="#source-httpswww.kaggle.comdatasetsmylesoneillgame-of-thrones"><span class="header-section-number">34.2</span> source: ## https://www.kaggle.com/datasets/mylesoneill/game-of-thrones</a></li>
  <li><a href="#rmlist-ls-remove-all-objects-from-environment-use-carefully" id="toc-rmlist-ls-remove-all-objects-from-environment-use-carefully" class="nav-link" data-scroll-target="#rmlist-ls-remove-all-objects-from-environment-use-carefully"><span class="header-section-number">34.3</span> rm(list = ls()) ## remove all objects from environment – use carefully!</a></li>
  <li><a href="#read-another-csv-file-16pf-questionnaire" id="toc-read-another-csv-file-16pf-questionnaire" class="nav-link" data-scroll-target="#read-another-csv-file-16pf-questionnaire"><span class="header-section-number">34.4</span> read another csv file — 16PF questionnaire</a></li>
  <li><a href="#source-httpswww.kaggle.comdatasetstunguzcattells-16-personality-factors" id="toc-source-httpswww.kaggle.comdatasetstunguzcattells-16-personality-factors" class="nav-link" data-scroll-target="#source-httpswww.kaggle.comdatasetstunguzcattells-16-personality-factors"><span class="header-section-number">34.5</span> source: https://www.kaggle.com/datasets/tunguz/cattells-16-personality-factors</a></li>
  <li><a href="#read-ket.csv-with-correct-tab-separator" id="toc-read-ket.csv-with-correct-tab-separator" class="nav-link" data-scroll-target="#read-ket.csv-with-correct-tab-separator"><span class="header-section-number">34.6</span> read ket.csv with correct tab separator</a></li>
  <li><a href="#get-some-basic-info-about-the-data" id="toc-get-some-basic-info-about-the-data" class="nav-link" data-scroll-target="#get-some-basic-info-about-the-data"><span class="header-section-number">34.7</span> get some basic info about the data</a></li>
  <li><a href="#get-some-descriptive-stats" id="toc-get-some-descriptive-stats" class="nav-link" data-scroll-target="#get-some-descriptive-stats"><span class="header-section-number">34.8</span> get some descriptive stats</a></li>
  <li><a href="#lets-start-with-a1-column-a1-item-in-questionnaire" id="toc-lets-start-with-a1-column-a1-item-in-questionnaire" class="nav-link" data-scroll-target="#lets-start-with-a1-column-a1-item-in-questionnaire"><span class="header-section-number">34.9</span> let’s start with A1 column (A1 item in questionnaire)</a></li>
  <li><a href="#or-another-way-using-group_by-summarise" id="toc-or-another-way-using-group_by-summarise" class="nav-link" data-scroll-target="#or-another-way-using-group_by-summarise"><span class="header-section-number">34.10</span> or another way using group_by() %&gt;% summarise()</a></li>
  <li><a href="#lets-fix-gender-var" id="toc-lets-fix-gender-var" class="nav-link" data-scroll-target="#lets-fix-gender-var"><span class="header-section-number">34.11</span> let’s fix gender var</a></li>
  <li><a href="#or-another-shorter-way" id="toc-or-another-shorter-way" class="nav-link" data-scroll-target="#or-another-shorter-way"><span class="header-section-number">34.12</span> or another shorter way</a></li>
  <li><a href="#lets-remove-na" id="toc-lets-remove-na" class="nav-link" data-scroll-target="#lets-remove-na"><span class="header-section-number">34.13</span> let’s remove NA</a></li>
  <li><a href="#lets-count-desriptive-stats-for-each-item-more-stylish" id="toc-lets-count-desriptive-stats-for-each-item-more-stylish" class="nav-link" data-scroll-target="#lets-count-desriptive-stats-for-each-item-more-stylish"><span class="header-section-number">34.14</span> let’s count desriptive stats for each item more stylish</a></li>
  <li><a href="#lets-do-it-for-the-age-first" id="toc-lets-do-it-for-the-age-first" class="nav-link" data-scroll-target="#lets-do-it-for-the-age-first"><span class="header-section-number">34.15</span> let’s do it for the age first</a></li>
  <li><a href="#breefly-check-basic-graphs" id="toc-breefly-check-basic-graphs" class="nav-link" data-scroll-target="#breefly-check-basic-graphs"><span class="header-section-number">34.16</span> breefly check basic graphs</a></li>
  <li><a href="#what-happens-if-we-set-some-threshold-for-the-age" id="toc-what-happens-if-we-set-some-threshold-for-the-age" class="nav-link" data-scroll-target="#what-happens-if-we-set-some-threshold-for-the-age"><span class="header-section-number">34.17</span> what happens, if we set some threshold for the age?</a></li>
  <li><a href="#lets-get-descripstipe-stats-for-all-items-at-once" id="toc-lets-get-descripstipe-stats-for-all-items-at-once" class="nav-link" data-scroll-target="#lets-get-descripstipe-stats-for-all-items-at-once"><span class="header-section-number">34.18</span> let’s get descripstipe stats for all items at once</a></li>
  <li><a href="#or-we-can-do-it-by-scale-using-selectstarts_with" id="toc-or-we-can-do-it-by-scale-using-selectstarts_with" class="nav-link" data-scroll-target="#or-we-can-do-it-by-scale-using-selectstarts_with"><span class="header-section-number">34.19</span> or we can do it by scale using select(starts_with(…))</a></li>
  <li><a href="#lets-draw-something-beautiful" id="toc-lets-draw-something-beautiful" class="nav-link" data-scroll-target="#lets-draw-something-beautiful"><span class="header-section-number">34.20</span> let’s draw something beautiful</a></li>
  <li><a href="#lets-draw-barplot-for-gender" id="toc-lets-draw-barplot-for-gender" class="nav-link" data-scroll-target="#lets-draw-barplot-for-gender"><span class="header-section-number">34.21</span> let’s draw barplot for gender</a></li>
  <li><a href="#lets-add-some-shine" id="toc-lets-add-some-shine" class="nav-link" data-scroll-target="#lets-add-some-shine"><span class="header-section-number">34.22</span> let’s add some shine</a></li>
  <li><a href="#lets-draw-distributions-of-items-scores" id="toc-lets-draw-distributions-of-items-scores" class="nav-link" data-scroll-target="#lets-draw-distributions-of-items-scores"><span class="header-section-number">34.23</span> let’s draw distributions of items scores</a></li>
  <li><a href="#again-we-can-do-something-to-make-it-better" id="toc-again-we-can-do-something-to-make-it-better" class="nav-link" data-scroll-target="#again-we-can-do-something-to-make-it-better"><span class="header-section-number">34.24</span> again we can do something to make it better</a></li>
  <li><a href="#lets-do-a-scatterplot-relation-between-age-and-total-score-of-scale-b-for-participants-from-us" id="toc-lets-do-a-scatterplot-relation-between-age-and-total-score-of-scale-b-for-participants-from-us" class="nav-link" data-scroll-target="#lets-do-a-scatterplot-relation-between-age-and-total-score-of-scale-b-for-participants-from-us"><span class="header-section-number">34.25</span> let’s do a scatterplot — relation between age and total score of scale B for participants from US</a></li>
  <li><a href="#and-again-add-some-shine" id="toc-and-again-add-some-shine" class="nav-link" data-scroll-target="#and-again-add-some-shine"><span class="header-section-number">34.26</span> and again add some shine</a></li>
  <li><a href="#oh-maybe-we-need-gender-on-the-plot" id="toc-oh-maybe-we-need-gender-on-the-plot" class="nav-link" data-scroll-target="#oh-maybe-we-need-gender-on-the-plot"><span class="header-section-number">34.27</span> oh, maybe we need gender on the plot?</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./part-r.html">Анализ данных в R</a></li><li class="breadcrumb-item"><a href="./r-preproc.html"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Предобработка данных</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Предобработка данных</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="install.packagestidyverse-dependencies-true" class="level1" data-number="22">
<h1 data-number="22"><span class="header-section-number">22</span> install.packages(“tidyverse”, dependencies = TRUE)</h1>
<p>library(tidyverse)</p>
<section id="working-dir" class="level2" data-number="22.1">
<h2 data-number="22.1" class="anchored" data-anchor-id="working-dir"><span class="header-section-number">22.1</span> working dir</h2>
</section>
</section>
<section id="getwd" class="level1" data-number="23">
<h1 data-number="23"><span class="header-section-number">23</span> getwd()</h1>
</section>
<section id="setwd" class="level1" data-number="24">
<h1 data-number="24"><span class="header-section-number">24</span> setwd()</h1>
<section id="get-data" class="level2" data-number="24.1">
<h2 data-number="24.1" class="anchored" data-anchor-id="get-data"><span class="header-section-number">24.1</span> get data</h2>
</section>
<section id="httpswww.kaggle.comdatasetsmylesoneillgame-of-thrones" class="level2" data-number="24.2">
<h2 data-number="24.2" class="anchored" data-anchor-id="httpswww.kaggle.comdatasetsmylesoneillgame-of-thrones"><span class="header-section-number">24.2</span> https://www.kaggle.com/datasets/mylesoneill/game-of-thrones</h2>
<p>deaths &lt;- read_csv(“data/character-deaths.csv”) str(deaths)</p>
<p>View(deaths)</p>
<p>nrow(deaths) ncol(deaths)</p>
<p>deaths$Allegiances</p>
<p>unique(deaths<span class="math inline">\(Allegiances)
unique(deaths\)</span>Gender) class(deaths$Gender)</p>
<p>table(deaths<span class="math inline">\(Gender)
sum(deaths\)</span>Gender) / length(deaths<span class="math inline">\(Gender)
mean(deaths\)</span>Gender)</p>
<p>colnames(deaths) # table(deaths<span class="math inline">\(Book of Death)
table(deaths\)</span><code>Book of Death</code>)</p>
<p>sort(table(deaths<span class="math inline">\(Allegiances))
max(table(deaths\)</span>Allegiances))</p>
</section>
<section id="what-is-pipe-and-how-it-works" class="level2" data-number="24.3">
<h2 data-number="24.3" class="anchored" data-anchor-id="what-is-pipe-and-how-it-works"><span class="header-section-number">24.3</span> what is pipe and how it works</h2>
<p>cos(0) 0 %&gt;% cos()</p>
<p>sqrt(cos(sin(4 * 8)))</p>
<p>(4 * 8) %&gt;% sin() %&gt;% cos() %&gt;% sqrt()</p>
<p>colnames(deaths) deaths %&gt;% rename(“Death_Year” = “Death Year”, “Book_of_Death” = “Book of Death”, “Death_Chapter” = “Death Chapter”, “Book_Intro_Chapter” = “Book Intro Chapter”) %&gt;% filter(Allegiances == “None”) -&gt; deaths_no_allegiance</p>
</section>
</section>
<section id="deaths" class="level1" data-number="25">
<h1 data-number="25"><span class="header-section-number">25</span> deaths %&gt;%</h1>
</section>
<section id="rename_all.funs-str_replace_all" class="level1" data-number="26">
<h1 data-number="26"><span class="header-section-number">26</span> rename_all(.funs = str_replace_all,</h1>
</section>
<section id="pattern" class="level1" data-number="27">
<h1 data-number="27"><span class="header-section-number">27</span> pattern = ” “,</h1>
</section>
<section id="replacement-_" class="level1" data-number="28">
<h1 data-number="28"><span class="header-section-number">28</span> replacement = “_“) %&gt;%</h1>
</section>
<section id="rename_alltolower" class="level1" data-number="29">
<h1 data-number="29"><span class="header-section-number">29</span> rename_all(tolower) %&gt;%</h1>
</section>
<section id="colnames" class="level1" data-number="30">
<h1 data-number="30"><span class="header-section-number">30</span> colnames()</h1>
</section>
<section id="colnamesdeaths_no_allegiance" class="level1" data-number="31">
<h1 data-number="31"><span class="header-section-number">31</span> colnames(deaths_no_allegiance)</h1>
</section>
<section id="colnamesdeaths" class="level1" data-number="32">
<h1 data-number="32"><span class="header-section-number">32</span> colnames(deaths)</h1>
<p>mean(deaths_no_allegiance<span class="math inline">\(Death_Year)
mean(deaths_no_allegiance\)</span>Death_Year, na.rm = TRUE)</p>
<p>deaths_no_allegiance %&gt;% summarise(n = n(), year_death_mean = mean(Death_Year), year_death_sd = sd(Death_Year), .by = Book_of_Death) %&gt;% #arrange(Book_of_Death) arrange(desc(Book_of_Death))</p>
<p>deaths_no_allegiance %&gt;% summarise(n = n(), chapter_death_median = median(Death_Chapter, na.rm = TRUE), chapter_death_iqr = IQR(Death_Chapter, na.rm = TRUE), .by = Book_of_Death) %&gt;% arrange(desc(Book_of_Death))</p>
<section id="nas" class="level2" data-number="32.1">
<h2 data-number="32.1" class="anchored" data-anchor-id="nas"><span class="header-section-number">32.1</span> NAs</h2>
<p>deaths$Allegiances == NA</p>
<p>is.na(deaths<span class="math inline">\(Allegiances)
is.na(deaths\)</span>Allegiances) %&gt;% sum() deaths$Allegiances %&gt;% is.na() %&gt;% sum()</p>
<p>is.na(deaths$<code>Death Year</code>) %&gt;% sum()</p>
<p>deaths %&gt;% sapply(is.na) %&gt;% apply(2, sum) deaths %&gt;% sapply(function(x) sum(is.na(x)))</p>
<p>deaths %&gt;% drop_na() # %&gt;% nrow() deaths %&gt;% filter(!is.na(<code>Book of Death</code>)) deaths %&gt;% filter(!(is.na(<code>Book of Death</code>) &amp; is.na(<code>Death Chapter</code>) &amp; is.na(<code>Death Year</code>)))</p>
<p>deaths %&gt;% mutate(Allegiances_Binary = ifelse(Allegiances == “None”, “No”, “Yes”)) %&gt;% # distinct(Allegiances_Binary, Nobility) summarise(n = n(), .by = c(Allegiances_Binary, Nobility))</p>
<p>deaths %&gt;% mutate(Allegiances = ifelse(Allegiances == “House Stark”, “Stark”, Allegiances)) %&gt;% filter(Allegiances == “Stark”) %&gt;% summarise(n = n(), .by = c(Allegiances, Gender))</p>
</section>
<section id="install-required-packages" class="level2" data-number="32.2">
<h2 data-number="32.2" class="anchored" data-anchor-id="install-required-packages"><span class="header-section-number">32.2</span> install required packages</h2>
</section>
</section>
<section id="install.packagestidyverse-moments" class="level1" data-number="33">
<h1 data-number="33"><span class="header-section-number">33</span> install.packages(“tidyverse”, “moments”)</h1>
<section id="another-way-to-install-required-packages-more-safe" class="level2" data-number="33.1">
<h2 data-number="33.1" class="anchored" data-anchor-id="another-way-to-install-required-packages-more-safe"><span class="header-section-number">33.1</span> another way to install required packages, more safe</h2>
<p>pkgs &lt;- c(“tidyverse”, “moments”) install.packages(pkgs[!pkgs %in% installed.packages()])</p>
</section>
<section id="load-required-package" class="level2" data-number="33.2">
<h2 data-number="33.2" class="anchored" data-anchor-id="load-required-package"><span class="header-section-number">33.2</span> load required package</h2>
<p>library(tidyverse)</p>
</section>
<section id="create-subfolder-for-data-files" class="level2" data-number="33.3">
<h2 data-number="33.3" class="anchored" data-anchor-id="create-subfolder-for-data-files"><span class="header-section-number">33.3</span> create subfolder for data files</h2>
</section>
</section>
<section id="dir.createdata" class="level1" data-number="34">
<h1 data-number="34"><span class="header-section-number">34</span> dir.create(“data”)</h1>
<section id="read-csv-file-separator-is-comma-data-of-got-charaster-deaths" class="level2" data-number="34.1">
<h2 data-number="34.1" class="anchored" data-anchor-id="read-csv-file-separator-is-comma-data-of-got-charaster-deaths"><span class="header-section-number">34.1</span> read csv file, separator is comma — data of GoT charaster deaths</h2>
</section>
<section id="source-httpswww.kaggle.comdatasetsmylesoneillgame-of-thrones" class="level2" data-number="34.2">
<h2 data-number="34.2" class="anchored" data-anchor-id="source-httpswww.kaggle.comdatasetsmylesoneillgame-of-thrones"><span class="header-section-number">34.2</span> source: ## https://www.kaggle.com/datasets/mylesoneill/game-of-thrones</h2>
<p>deaths &lt;- read_csv(“data/character-deaths.csv”) str(deaths) ## check structure rm(deaths) ## remove object, we’ll not use it in this script</p>
</section>
<section id="rmlist-ls-remove-all-objects-from-environment-use-carefully" class="level2" data-number="34.3">
<h2 data-number="34.3" class="anchored" data-anchor-id="rmlist-ls-remove-all-objects-from-environment-use-carefully"><span class="header-section-number">34.3</span> rm(list = ls()) ## remove all objects from environment – use carefully!</h2>
</section>
<section id="read-another-csv-file-16pf-questionnaire" class="level2" data-number="34.4">
<h2 data-number="34.4" class="anchored" data-anchor-id="read-another-csv-file-16pf-questionnaire"><span class="header-section-number">34.4</span> read another csv file — 16PF questionnaire</h2>
</section>
<section id="source-httpswww.kaggle.comdatasetstunguzcattells-16-personality-factors" class="level2" data-number="34.5">
<h2 data-number="34.5" class="anchored" data-anchor-id="source-httpswww.kaggle.comdatasetstunguzcattells-16-personality-factors"><span class="header-section-number">34.5</span> source: https://www.kaggle.com/datasets/tunguz/cattells-16-personality-factors</h2>
<p>ket &lt;- read_csv(“data/ket.csv”) ## pay attertion to message in console str(ket) ## check structure — see smth strange?</p>
</section>
<section id="read-ket.csv-with-correct-tab-separator" class="level2" data-number="34.6">
<h2 data-number="34.6" class="anchored" data-anchor-id="read-ket.csv-with-correct-tab-separator"><span class="header-section-number">34.6</span> read ket.csv with correct tab separator</h2>
<p>ket &lt;- read_tsv(“data/ket.csv”) ## rewrite ket object str(ket) ## check structure again — now looks good View(ket) ## another way to check head(ket) ## look at several (6 by default) first rows tail(ket, n = 4) ## look at several (4 in this case) last rows</p>
</section>
<section id="get-some-basic-info-about-the-data" class="level2" data-number="34.7">
<h2 data-number="34.7" class="anchored" data-anchor-id="get-some-basic-info-about-the-data"><span class="header-section-number">34.7</span> get some basic info about the data</h2>
<p>nrow(ket) ## number of rows ncol(ket) ## number of columns colnames(ket) ## names of columns class(ket) ## wow, that’s dataframe/tibble sapply(ket, class) ## check data type of each column — apply class function to each column of our data</p>
</section>
<section id="get-some-descriptive-stats" class="level2" data-number="34.8">
<h2 data-number="34.8" class="anchored" data-anchor-id="get-some-descriptive-stats"><span class="header-section-number">34.8</span> get some descriptive stats</h2>
</section>
<section id="lets-start-with-a1-column-a1-item-in-questionnaire" class="level2" data-number="34.9">
<h2 data-number="34.9" class="anchored" data-anchor-id="lets-start-with-a1-column-a1-item-in-questionnaire"><span class="header-section-number">34.9</span> let’s start with A1 column (A1 item in questionnaire)</h2>
<p>mean(ket<span class="math inline">\(A1) ## [arithmetic] mean
mean(ket\)</span>A1, trim = .2) ## trimmed mean</p>
<p>?mean ## what’s the ‘trim’ argument in previous? let’s see help about the ‘mean’ function help(mean) ## or let’s see help this way</p>
<p>var(ket<span class="math inline">\(A1) ## variance (dispersion)
sd(ket\)</span>A1) ## standard deviation median(ket<span class="math inline">\(A1) ## median
quantile(ket\)</span>A1) ## by default — return quartiles quantile(ket<span class="math inline">\(A1, probs = .20) ## you may tell R, what specific quantile you are interested in
max(ket\)</span>A1) ## get max value min(ket<span class="math inline">\(A1) ## get min value
table(ket\)</span>A1) ## get prop table, A1 is discrete var, it will work table(ket<span class="math inline">\(country) ## or same for countries --- doesn't look so good
sort(table(ket\)</span>country)) ## let’s sort previous output (ascending by default) — now looks better sort(table(ket<span class="math inline">\(country), decreasing = TRUE) ## you may sort it descending as well
ket\)</span>country %&gt;% table() %&gt;% sort(decreasing = TRUE) ## same as previous line, but tidyverse-styles with pipe</p>
</section>
<section id="or-another-way-using-group_by-summarise" class="level2" data-number="34.10">
<h2 data-number="34.10" class="anchored" data-anchor-id="or-another-way-using-group_by-summarise"><span class="header-section-number">34.10</span> or another way using group_by() %&gt;% summarise()</h2>
<p>ket %&gt;% ## take data group_by(country) %&gt;% ## group data by country summarise( ## calculate something n = n() ## number of observations ) %&gt;% # arrange(n) ## arrange (sort) aggregated data by new column ‘n’ — ascending by default arrange(desc(n)) ## arrange (sort) aggregated data by new column ‘n’ — now descending</p>
<p>ket %&gt;% filter(country == “US”) %&gt;% nrow() ket %&gt;% filter(country == “US” &amp; country == “FR”) %&gt;% nrow() ket %&gt;% filter(country == “US” | country == “RU”) %&gt;% nrow() ket %&gt;% filter(age &lt; 18) %&gt;% nrow() ket %&gt;% filter(age &gt; 18 &amp; age &lt; 35) %&gt;% nrow() ket %&gt;% filter(age &lt; 18 &amp; age &gt; 60) %&gt;% nrow()</p>
<p>summary(ket) ## get basic descriptive stats for all columns</p>
<p>ket$A1 %&gt;% is.na() %&gt;% sum() ## check number of NA in A1 columns — no NA, cool! ket %&gt;% sapply(is.na) %&gt;% apply(2, sum) ## check number of NA for all columns ket %&gt;% sapply(function(x) x %&gt;% is.na() %&gt;% sum()) ## check number of NA for all columns another way — same result</p>
<p>unique(ket$gender) ## check unique values of gender variable — hmmm, need codebook…</p>
</section>
<section id="lets-fix-gender-var" class="level2" data-number="34.11">
<h2 data-number="34.11" class="anchored" data-anchor-id="lets-fix-gender-var"><span class="header-section-number">34.11</span> let’s fix gender var</h2>
<p>ket %&gt;% mutate( gender = ifelse(gender == 0, NA, ifelse(gender == 1, “male”, ifelse(gender == 2, “female”, “other”))) ) %&gt;% pull(gender) %&gt;% ## pull gender column as vector # is.na() %&gt;% sum() ## check number of NA unique() ## check unique values ## we didn’t save these changes!</p>
</section>
<section id="or-another-shorter-way" class="level2" data-number="34.12">
<h2 data-number="34.12" class="anchored" data-anchor-id="or-another-shorter-way"><span class="header-section-number">34.12</span> or another shorter way</h2>
<p>ket %&gt;% ## take data mutate( ## change something gender = recode( ## save to gender (rewrite column) as follow [according codebook] gender, ## take gender var “0” = NA_character_, ## set NA for 0 — recode function requires explicit type of NA “1” = “male”, ## set ‘male’ for 1 “2” = “female”, ## set ‘female’ for 2 “3” = “other” ## set ‘other’ for 3 ) ) -&gt; ket ## save changes ket %&gt;% pull(gender) %&gt;% unique() ## check new gender values</p>
</section>
<section id="lets-remove-na" class="level2" data-number="34.13">
<h2 data-number="34.13" class="anchored" data-anchor-id="lets-remove-na"><span class="header-section-number">34.13</span> let’s remove NA</h2>
<p>ket %&gt;% drop_na() ## remove all rows that contains at least one NA ket %&gt;% drop_na() %&gt;% nrow() ## check the number of rows after NA removing — ok, appropriate ket %&gt;% drop_na() -&gt; cattel ## save the data without NA to new object</p>
</section>
<section id="lets-count-desriptive-stats-for-each-item-more-stylish" class="level2" data-number="34.14">
<h2 data-number="34.14" class="anchored" data-anchor-id="lets-count-desriptive-stats-for-each-item-more-stylish"><span class="header-section-number">34.14</span> let’s count desriptive stats for each item more stylish</h2>
</section>
<section id="lets-do-it-for-the-age-first" class="level2" data-number="34.15">
<h2 data-number="34.15" class="anchored" data-anchor-id="lets-do-it-for-the-age-first"><span class="header-section-number">34.15</span> let’s do it for the age first</h2>
<p>cattel %&gt;% ## take data summarise( ## calculate something n_age = n(), ## number of observations — name output column as ‘n_age’ mean_age = mean(age), ## mean age — name output column as ‘mean_age’ sd_age = sd(age), ## standard deviation of age — name output column as ‘sd_age’ max_age = max(age), ## max age — name output column as ‘max_age’ min_age = min(age) ## min age — name output column as ‘min_age’ ) ## or simplier cattel %&gt;% ## take data summarise( ## calculate something n = n(), ## number of observations — name output column as ‘n’ mean = mean(age), ## mean age — name output column as ‘mean’ sd = sd(age), ## standard deviation of age — name output column as ‘sd’ max = max(age), ## max age — name output column as ‘max’ min = min(age) ## min age — name output column as ‘min’ ) ## hmmm, look at max age</p>
</section>
<section id="breefly-check-basic-graphs" class="level2" data-number="34.16">
<h2 data-number="34.16" class="anchored" data-anchor-id="breefly-check-basic-graphs"><span class="header-section-number">34.16</span> breefly check basic graphs</h2>
<p>hist(cattel<span class="math inline">\(age) ## histogram
boxplot(cattel\)</span>age) ## boxplot</p>
</section>
<section id="what-happens-if-we-set-some-threshold-for-the-age" class="level2" data-number="34.17">
<h2 data-number="34.17" class="anchored" data-anchor-id="what-happens-if-we-set-some-threshold-for-the-age"><span class="header-section-number">34.17</span> what happens, if we set some threshold for the age?</h2>
<p>cattel %&gt;% # nrow() filter(age &lt;= 100) %&gt;% # nrow() pull(age) %&gt;% boxplot() ## ok, more or less</p>
<p>cattel %&gt;% filter(age &lt;= 100) -&gt; cattel ## remove inappropriate observations (based on age), rewrite data</p>
</section>
<section id="lets-get-descripstipe-stats-for-all-items-at-once" class="level2" data-number="34.18">
<h2 data-number="34.18" class="anchored" data-anchor-id="lets-get-descripstipe-stats-for-all-items-at-once"><span class="header-section-number">34.18</span> let’s get descripstipe stats for all items at once</h2>
<p>cattel %&gt;% # colnames() select(cols = -c(age, gender, accuracy, country, source, elapsed)) %&gt;% # colnames() ## [de]select cols pivot_longer( ## pivot data to long format cols = everything(), ## with all columns names_to = “item”, ## name column with titles as ‘item’ values_to = “score” ## name column with values as ‘score’ ) %&gt;% summarise( ## calculate something n = n(), ## number of observations mean = mean(score), ## mean score median = median(score), ## median score sd = sd(score), ## sd of score min = min(score), ## min score max = max(score), ## max score skew = moments::skewness(score), ## skewness of score — call function skewness() from moments package kurt = moments::kurtosis(score), ## kurtosis of score — call function kurtosis() from moments package .by = “item” ## group rows by ‘item’ variable ) # %&gt;% filter(str_detect(item, “^A”)) ## filter rows where item name starts with A</p>
</section>
<section id="or-we-can-do-it-by-scale-using-selectstarts_with" class="level2" data-number="34.19">
<h2 data-number="34.19" class="anchored" data-anchor-id="or-we-can-do-it-by-scale-using-selectstarts_with"><span class="header-section-number">34.19</span> or we can do it by scale using select(starts_with(…))</h2>
<p>cattel %&gt;% select(cols = -c(age, gender, accuracy, country, source, elapsed)) %&gt;% # colnames() ## [de]select cols select(starts_with(“A”)) %&gt;% ## select all columns where name starts with ‘A’ pivot_longer( ## pivot data to long format cols = everything(), ## with all columns names_to = “item”, ## name column with titles as ‘item’ values_to = “score” ## name column with values as ‘score’ ) %&gt;% summarise( ## calculate something n = n(), ## number of observations mean = mean(score), ## mean score median = median(score), ## median score sd = sd(score), ## sd of score min = min(score), ## min score max = max(score), ## max score skew = moments::skewness(score), ## skewness of score — call function skewness() from moments package kurt = moments::kurtosis(score), ## kurtosis of score — call function kurtosis() from moments package .by = “item” ## group rows by ‘item’ variable )</p>
</section>
<section id="lets-draw-something-beautiful" class="level2" data-number="34.20">
<h2 data-number="34.20" class="anchored" data-anchor-id="lets-draw-something-beautiful"><span class="header-section-number">34.20</span> let’s draw something beautiful</h2>
<p>ggplot() ## we need canvas</p>
<p>cattel %&gt;% ## and also we need data ggplot() ## not really impressive for now</p>
</section>
<section id="lets-draw-barplot-for-gender" class="level2" data-number="34.21">
<h2 data-number="34.21" class="anchored" data-anchor-id="lets-draw-barplot-for-gender"><span class="header-section-number">34.21</span> let’s draw barplot for gender</h2>
<p>cattel %&gt;% ggplot(aes(gender)) ## tell ggplot <em>what</em> variable we would like to draw ## hmmm, ok</p>
<p>cattel %&gt;% ggplot(aes(gender)) + geom_bar() ## tell ggplot <em>how</em> we would like to draw it ## well, kinda</p>
</section>
<section id="lets-add-some-shine" class="level2" data-number="34.22">
<h2 data-number="34.22" class="anchored" data-anchor-id="lets-add-some-shine"><span class="header-section-number">34.22</span> let’s add some shine</h2>
<p>cattel %&gt;% ggplot(aes(gender)) + geom_bar() + theme_bw() + labs(x = “Пол”, y = “Частота”) + scale_x_discrete(labels = c(“female” = “Женский”, “male” = “Мужской”, “other” = “Другое”))</p>
</section>
<section id="lets-draw-distributions-of-items-scores" class="level2" data-number="34.23">
<h2 data-number="34.23" class="anchored" data-anchor-id="lets-draw-distributions-of-items-scores"><span class="header-section-number">34.23</span> let’s draw distributions of items scores</h2>
<p>theme_set(theme_minimal()) ## set minimalistic theme for all future graphs cattel %&gt;% select(starts_with(“A”, ignore.case = FALSE)) %&gt;% pivot_longer(cols = everything()) %&gt;% ggplot(aes(value)) + geom_bar() + facet_wrap(~ name) ## make subgraph for each item ## well, not bad</p>
</section>
<section id="again-we-can-do-something-to-make-it-better" class="level2" data-number="34.24">
<h2 data-number="34.24" class="anchored" data-anchor-id="again-we-can-do-something-to-make-it-better"><span class="header-section-number">34.24</span> again we can do something to make it better</h2>
<p>cattel %&gt;% select(starts_with(“A”, ignore.case = FALSE)) %&gt;% pivot_longer(cols = everything()) %&gt;% ggplot(aes(value)) + geom_bar() + facet_wrap(~ factor(name, ## make subgraph for each item ordered = TRUE, levels = paste0(“A”, 1:10) ## order them correctly ), scales = “free_x” ## save x-labels for each subgraph ) + scale_x_continuous(breaks = 0:5) + ## make all point on x axis visible labs(x = “Балл”, ## set label to x axis y = “Частота” ## set label to y axis )</p>
</section>
<section id="lets-do-a-scatterplot-relation-between-age-and-total-score-of-scale-b-for-participants-from-us" class="level2" data-number="34.25">
<h2 data-number="34.25" class="anchored" data-anchor-id="lets-do-a-scatterplot-relation-between-age-and-total-score-of-scale-b-for-participants-from-us"><span class="header-section-number">34.25</span> let’s do a scatterplot — relation between age and total score of scale B for participants from US</h2>
<p>cattel %&gt;% mutate(id = 1:nrow(cattel)) %&gt;% ## create id column — just a number of the row in dataset filter(country == “US”) %&gt;% ## filter US participants select(starts_with(“B”), age, id) %&gt;% ## select columns we need pivot_longer( cols = -c(age, id), ## pivot to long format, ignore columns age and id names_to = “item”, ## put name to ‘item’ column values_to = “score” ## put values to ‘score’ column ) %&gt;% ## summarise( ## calculate something total_score = sum(score), ## total score as sum of item scores .by = c(age, id) ## for each participant (id) and preserve age column for future visualization ) %&gt;% ggplot(aes(age, total_score)) + ## use age as x and total as y geom_point() ## draw points</p>
</section>
<section id="and-again-add-some-shine" class="level2" data-number="34.26">
<h2 data-number="34.26" class="anchored" data-anchor-id="and-again-add-some-shine"><span class="header-section-number">34.26</span> and again add some shine</h2>
<p>cattel %&gt;% mutate(id = 1:nrow(cattel)) %&gt;% filter(country == “US”) %&gt;% select(starts_with(“B”), age, id) %&gt;% pivot_longer(cols = -c(age, id), names_to = “item”, values_to = “score”) %&gt;% summarise(total_score = sum(score), .by = c(age, id)) %&gt;% ggplot(aes(age, total_score)) + geom_point(alpha = .5) + ## set transparency for points (alpha channel) labs( x = “Возраст”, ## set x label y = “Суммарный балл”, ## set y label title = “Связь выраженности личностных черт респондентов с их возрастом”, ## set graph title subtitle = “Шкала B опросника 16PF”, ## set graph subtitle caption = “данные по респондентам из США” ## add graph caption )</p>
</section>
<section id="oh-maybe-we-need-gender-on-the-plot" class="level2" data-number="34.27">
<h2 data-number="34.27" class="anchored" data-anchor-id="oh-maybe-we-need-gender-on-the-plot"><span class="header-section-number">34.27</span> oh, maybe we need gender on the plot?</h2>
<p>cattel %&gt;% mutate(id = 1:nrow(cattel)) %&gt;% filter(country == “US”) %&gt;% select(starts_with(“B”), age, id, gender) %&gt;% ## now select all B scale items, age, id, and gender pivot_longer(cols = -c(age, id, gender), ## pivot to long format, ignore columns age, id, and gender names_to = “item”, values_to = “score”) %&gt;% summarise( ## calculate something total_score = sum(score), ## total score as sum of item scores .by = c(age, id) ## for each participant (id) and preserve age and gender columns for future visualization ) %&gt;% ggplot(aes(age, ## use age as x total_score, ## use total_score as y color = gender) ## and display gender with color ) + geom_point(alpha = .5) + ## set transparency for points theme(legend.position = “bottom”) + ## place color legend below the plot scale_color_discrete(labels = c(“female” = “Женский”, ## set labels for color “male” = “Мужской”, “other” = “Другое”)) + labs(x = “Возраст”, y = “Суммарный балл”, color = “Пол”, ## set label for color legend title = “Связь выраженности личностных черт респондентов с их возрастом”, subtitle = “Шкала B опросника 16PF”, caption = “данные по респондентам из США”)</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Скопировано!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Скопировано!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./r-intro.html" class="pagination-link" aria-label="Основы R">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Основы R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./r-vis.html" class="pagination-link" aria-label="Визуализация данных">
        <span class="nav-page-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Визуализация данных</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>